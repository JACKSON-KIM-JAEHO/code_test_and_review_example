name: Code Review

permissions:
  contents: read
  pull-requests: write

on:
  pull_request:
    types: [opened, synchronize]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: inmo-jang/ChatGPT-CodeReview@main
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
          OPENAI_API_KEY: ${{ secrets.OPENAI_API_KEY }}
          MODEL: gpt-4o-mini # https://platform.openai.com/docs/models
          PROMPT: You are an expert code reviewer. Your task is to review pull request changes in the provided code diff. Identify issues or areas for improvement in the code. Suggest concrete, actionable improvements. Use Markdown for formatting. Only comment on issues or areas that require attention. Do not provide compliments or generic comments. Include the affected line number in your feedback.
          temperature: 0.3 # https://platform.openai.com/docs/api-reference/chat/create#chat/create-temperature
          max_tokens: 10000
          MAX_PATCH_LENGTH: 10000 # if the patch/diff length is large than MAX_PATCH_LENGTH, will be ignored and won't review. By default, with no MAX_PATCH_LENGTH set, there is also no limit for the patch/diff length.
          IGNORE_PATTERNS: *.md,*.yaml,*.png # glob pattern or regex pattern to ignore files, separated by comma
